<!-- small moon -->
<html>
<head>
<!--
 - - - - -
Scrollable list based off:
http://stackoverflow.com/questions/21998679/css-how-to-make-scrollable-list

CORS
https://hacks.mozilla.org/2009/07/cross-site-xmlhttprequest-with-cors/
-->
<meta http-equiv="Content-Type" content="text/html;utf-8"> 

<!--
///////////////////////////////////////////////////////////////////
Plastic CSS
-->
<style>
 nav ul{height:215px; width:90%;}
 nav ul{overflow:hidden; overflow-y:scroll;}
 nav ul{list-style-type:none;}
 img.map, map area {
  outline: none;
 }
</style>

<!--
///////////////////////////////////////////////////////////////////
Plastic JavaScript
-->

<script type="text/javascript">

///////////////////////////////////////////////////////////////////
//
// Translation menu and handlers: see more, offer another, edit, delete
// The history, lock links direct to the developer wiki - reader can 
// implement if they want: my purpose is not full-feature implementation here.
//
///////////////////////////////////////////////////////////////////

function trnPreferAnother($index) {
 $status = localStorage.getItem($ls + '.result');
 if ($status != 200) {
  // if we're showing undefined, then there is no "see more" to look at
  // and the user would need to change the lang(s) and refresh to see more.
  $choices = "No more translations found";
 } else {
  // if we're showing defined by contrast the representation will be storing
  // a link to the all preferable resource (visit_link/langs/all)
  $res = localStorage.getItem('csi18n_seemore.representations');
  $json_arr = JSON.parse($res);

  $json_arr.csi18n_xlate_resources = $json_arr.csi18n_xlate_resources.slice($index, $index + 1);
  $res = JSON.stringify($json_arr);

  $url = localStorage.getItem('csi18n_seemore.per_lang_pref');

  if (XMLHttpRequest) {
    var request = new XMLHttpRequest();
    if("withCredentials" in request) {
     // Firefox 3.5 and Safari 4
     request.open('PUT', $url, true);
     request.setRequestHeader("Authorization", "Basic dGVzdDA1OnRlc3Q=");
     request.setRequestHeader("X-APIKey", "e3c12c03cf320b243977d6ac389805de");
     request.setRequestHeader("Content-Type", "application/json;v=1.0");
     request.onload = preferanother_handler;
     request.send($res);
    }
  }
 }
}

function trnSeeMore($ls) {
 localStorage.setItem('csi18n_seemore.representations', '');
 $status = localStorage.getItem($ls + '.result');
 if ($status != 200) {
  // if we're showing undefined, then there is no "see more" to look at
  // and the user would need to change the lang(s) and refresh to see more.
  $choice = "No more translations found";
  var d = document.getElementById("trn_menu");
  d.style.position = "fixed";
  d.style.fontFamily = "sans";
  d.style.right = "0px";
  d.style.top = "240px";
  d.style.zIndex = "101";
  d.style.backgroundColor = "#AADDDD";
  d.style.textAlign = "right";
  d.style.fontSize = "20px";

  $choices = "See more<hr>" + $choice;
  d.innerHTML = escapeHtml($choices);
  d.style.display = "";

 } else {
  // if we're showing defined by contrast the representation will be storing
  // a link to the all preferable resource (visit_link/langs/all)
  $res = localStorage.getItem($ls + '.representation');
  $json = JSON.parse($res);
  $url = $json.csi18n_all_preferable;

  if (XMLHttpRequest) {
    var request = new XMLHttpRequest();
    if("withCredentials" in request) {
     // Firefox 3.5 and Safari 4
     $lang = localStorage.getItem('csi18n_lang');
     if ($lang == null) {
      $lang = window.navigator.language;
     }
     request.open('GET', $url, true);
     request.setRequestHeader("Authorization", "Basic dGVzdDA1OnRlc3Q=");
     request.setRequestHeader("X-APIKey", "e3c12c03cf320b243977d6ac389805de");
     request.setRequestHeader("Accept", "application/json");
     request.responseType = "json";
     request.onload = seemore_handler;
     request.send();
    }
  }
 }
}

function trnOptions($ls) {
 var $tlink = localStorage.getItem($ls + '.tlink');

 var d = document.getElementById("trn_menu");
 d.style.position = "fixed";
 d.style.fontFamily = "sans";
 d.style.right = "0px";
 d.style.top = "240px";
 d.style.width = "401px";
 d.style.height = "240px";
 d.style.zIndex = "100";
 d.style.backgroundColor = "#AADDDD";
 d.style.textAlign = "right";
 d.style.fontSize = "20px";
 d.innerHTML =  "Options<hr>" +
 "<input type='button' value='Options' style='font-size:21px' onClick='javascript:sendOptions(\"" + $ls + "\")'>";
 d.style.display = "";
}

function trnHead($ls) {
 var $tlink = localStorage.getItem($ls + '.tlink');

 var d = document.getElementById("trn_menu");
 d.style.position = "fixed";
 d.style.fontFamily = "sans";
 d.style.right = "0px";
 d.style.top = "240px";
 d.style.width = "401px";
 d.style.height = "240px";
 d.style.zIndex = "100";
 d.style.backgroundColor = "#AADDDD";
 d.style.textAlign = "right";
 d.style.fontSize = "20px";
 d.innerHTML =  "Head<hr>" +
 "<input type='button' value='Head' style='font-size:21px' onClick='javascript:sendHead(\"" + $ls + "\")'>";
 d.style.display = "";
}

function trnOfferAnother($ls) {
 var $result = localStorage.getItem($ls + '.result');
 var $newmark = localStorage.getItem($ls + '.newmark');
 var $visitsid = localStorage.getItem($ls + '.visitsid');
 var $rep = localStorage.getItem($ls + '.representation');
 var $tlink = localStorage.getItem($ls + '.tlink');

 if ($result == 200) {
  // yes yes, 200 is not the only response
  $json_o = JSON.parse($rep);
  $newmark = $json_o.csi18n_xlate_resource.newmark;
  $lang = $json_o.csi18n_xlate_resource.language;
  $trans = $json_o.csi18n_xlate_resource.translation;
  $vis = $json_o.csi18n_xlate_resource.visibility;
 } else {
  $lang = localStorage.getItem('csi18n_lang');
  if ($lang == null) {
   $lang = window.navigator.language;
  }
  $trans = '';
  $vis = '';
 }
 var isano = ($vis == 'anonymous') ? 'selected' : '';
 var ispub = ($vis == 'public') ? 'selected' : '';
 var isprv = ($vis == 'private') ? 'selected' : '';
 var isper = ($vis == 'personal') ? 'selected' : '';

 var d = document.getElementById("trn_menu");
 d.style.position = "fixed";
 d.style.fontFamily = "sans";
 d.style.right = "0px";
 d.style.top = "240px";
 d.style.zIndex = "100";
 d.style.backgroundColor = "#AADDDD";
 d.style.textAlign = "right";
 d.style.fontSize = "20px";
 d.innerHTML = "Offer another<hr>" +
 "<input type='text' value='" + $newmark + "' disabled='' size='30' name='newmark_iv' id='newmark_iv' style='font-size:21px'>Newmark<br>" +
 "<input type='text' value='" + $lang + "' size='30' name='cl_iv' id='cl_iv' style='font-size:21px'>Content-Language<br>" +
 "<textarea cols='20' rows='3' name='translation_iv' id='translation_iv' type='text' style='font-size:21px'>" + $trans + "</textarea>Translation<br>" +
 "<select size='4' name='visibility_iv' id='visibility_iv' style='font-size:21px'>" +
 "<option value='anonymous' " + isano + ">Anonymous</option>" +
 "<option value='public' " + ispub + ">Public</option>" +
 "<option value='private' " + isprv + ">Private</option>" +
 "<option value='personal' " + isper + ">Personal</option>" +
 "</select>Visibility<br>" +
 "<input type='hidden' value='" + $visitsid + "' name='visitsid'>" +
 "<input type='hidden' value='test05' name='un'>" +
 "<input type='hidden' value='e3c12c03cf320b243977d6ac389805de' name='apikey'>" +
 "<input type='hidden' value='test' name='pw'>" +
 "<input type='button' value='Submit' style='font-size:21px' onClick='javascript:sendPost(" + $visitsid + ")'>";
 d.style.display = "";
}

function trnDelete($ls) {
 var $result = localStorage.getItem($ls + '.result');
 var $newmark = localStorage.getItem($ls + '.newmark');
 var $rep = localStorage.getItem($ls + '.representation');
 var $tlink = localStorage.getItem($ls + '.tlink');

 if ($result == 200) {
  // yes yes, 200 is not the only response
  $json_o = JSON.parse($rep);
  $newmark = $json_o.csi18n_xlate_resource.newmark;
  $lang = $json_o.csi18n_xlate_resource.language;
  $trans = $json_o.csi18n_xlate_resource.translation;
  $vis = $json_o.csi18n_xlate_resource.visibility;
 } else {
  $lang = localStorage.getItem('csi18n_lang');
  if ($lang == null) {
   $lang = window.navigator.language;
  }
  $trans = '';
  $vis = '';
 }
 var isano = ($vis == 'anonymous') ? 'selected' : '';
 var ispub = ($vis == 'public') ? 'selected' : '';
 var isprv = ($vis == 'private') ? 'selected' : '';
 var isper = ($vis == 'personal') ? 'selected' : '';

 var d = document.getElementById("trn_menu");
 d.style.position = "fixed";
 d.style.fontFamily = "sans";
 d.style.right = "0px";
 d.style.top = "240px";
 d.style.zIndex = "100";
 d.style.backgroundColor = "#AADDDD";
 d.style.textAlign = "right";
 d.style.fontSize = "20px";
 d.innerHTML = "Delete<hr>" +
 "<input type='text' value='" + $newmark + "' disabled size='30' name='newmark_iv' id='newmark_iv' style='font-size:21px'>Newmark<br>" +
 "<input type='text' value='" + $lang + "' disabled size='30' name='cl_iv' id='cl_iv' style='font-size:21px'>Content-Language<br>" +
 "<textarea disabled cols='30' rows='3' name='translation_iv' id='translation_iv' type='text' style='font-size:21px'>" + $trans + "</textarea>Translation<br>" +
 "<select disabled size='4' name='visibility_iv' id='visibility_iv' style='font-size:21px'>" +
 "<option value='anonymous' " + isano + ">Anonymous</option>" +
 "<option value='public' " + ispub + ">Public</option>" +
 "<option value='private' " + isprv + ">Private</option>" +
 "<option value='personal' " + isper + ">Personal</option>" +
 "</select>Visibility<br>" +
 "<input type='hidden' value='1' name='visitsid'>" +
 "<input type='hidden' value='test05' name='un'>" +
 "<input type='hidden' value='e3c12c03cf320b243977d6ac389805de' name='apikey'>" +
 "<input type='hidden' value='test' name='pw'>" +
 "<input type='button' value='Delete' style='font-size:21px' onClick='javascript:sendDelete(\"" + $ls + "\")'>";
 d.style.display = "";
}

function trnEdit($ls) {
 var $result = localStorage.getItem($ls + '.result');
 var $newmark = localStorage.getItem($ls + '.newmark');
 var $rep = localStorage.getItem($ls + '.representation');
 var $tlink = localStorage.getItem($ls + '.tlink');

 if ($result == 200) {
  // yes yes, 200 is not the only response
  $json_o = JSON.parse($rep);
  $newmark = $json_o.csi18n_xlate_resource.newmark;
  $lang = $json_o.csi18n_xlate_resource.language;
  $trans = $json_o.csi18n_xlate_resource.translation;
  $vis = $json_o.csi18n_xlate_resource.visibility;
 } else {
  $lang = localStorage.getItem('csi18n_lang');
  if ($lang == null) {
   $lang = window.navigator.language;
  }
  $trans = '';
  $vis = '';
 }
 var isano = ($vis == 'anonymous') ? 'selected' : '';
 var ispub = ($vis == 'public') ? 'selected' : '';
 var isprv = ($vis == 'private') ? 'selected' : '';
 var isper = ($vis == 'personal') ? 'selected' : '';

 var d = document.getElementById("trn_menu");
 d.style.position = "fixed";
 d.style.fontFamily = "sans";
 d.style.right = "0px";
 d.style.top = "240px";
 d.style.zIndex = "100";
 d.style.backgroundColor = "#AADDDD";
 d.style.textAlign = "right";
 d.style.fontSize = "20px";
 d.innerHTML = "Edit<hr>" +
 "<input type='text' value='" + $newmark + "' disabled='' size='30' name='newmark_iv' id='newmark_iv' style='font-size:21px'>Newmark<br>" +
 "<input type='text' value='" + $lang + "' size='30' name='cl_iv' id='cl_iv' style='font-size:21px'>Content-Language<br>" +
 "<textarea cols='30' rows='3' name='translation_iv' id='translation_iv' type='text' style='font-size:21px'>" + $trans + "</textarea>Translation<br>" +
 "<select size='4' name='visibility_iv' id='visibility_iv' style='font-size:21px'>" +
 "<option value='anonymous' " + isano + ">Anonymous</option>" +
 "<option value='public' " + ispub + ">Public</option>" +
 "<option value='private' " + isprv + ">Private</option>" +
 "<option value='personal' " + isper + ">Personal</option>" +
 "</select>Visibility<br>" +
 "<input type='hidden' value='1' name='visitsid'>" +
 "<input type='hidden' value='test05' name='un'>" +
 "<input type='hidden' value='e3c12c03cf320b243977d6ac389805de' name='apikey'>" +
 "<input type='hidden' value='test' name='pw'>" +
 "<input type='button' value='Submit' style='font-size:21px' onClick='javascript:sendPut(\"" + $ls + "\")'>";
 d.style.display = "";
}

///////////////////////////////////////////////////////////////////

//
// Functions for effecting the various HTTP method calls
//
// Note that these all make CORS requests in the background first, as the
// call are all Cross Origin in nature.
//
// The functions to send the request appear first; the callback handlers
// for when the server has replied appear after
// 
function sendGet($el, $newmark, $visitsid) {
 var url = "https://rest.mpsvr.com/newmarks/" + $visitsid + "/" + $newmark;
 if (XMLHttpRequest) {
   var request = new XMLHttpRequest();
   if("withCredentials" in request) {
    // Firefox 3.5 and Safari 4
    $lang = localStorage.getItem('csi18n_lang');
    if ($lang == null) {
     $lang = window.navigator.language;
    }
    request.open('GET', url, true);
    request.setRequestHeader("Authorization", "Basic dGVzdDA1OnRlc3Q=");
    request.setRequestHeader("X-APIKey", "e3c12c03cf320b243977d6ac389805de");
    request.setRequestHeader("Accept", "application/json");
    request.responseType = "json";
    request.setRequestHeader("Accept-Language", $lang);
    request.setRequestHeader("If-Modified-Since", "Tue,  1 Jan 1980 19:12:53 BST");
    request.setRequestHeader("If-None-Match", "Wibble");
    if ($el == 'fr0001') {
     request.onload = handler_fr0001;
    } else if ($el == 'fr0101') {
     request.onload = handler_fr0101;
    } else if ($el == 'fr0102') {
     request.onload = handler_fr0102;
    } else if ($el == 'fr0103') {
     request.onload = handler_fr0103;
    } else if ($el == 'fr0104') {
     request.onload = handler_fr0104;

    } else if ($el == 'fr0201') {
     request.onload = handler_fr0201;
    } else if ($el == 'fr0202') {
     request.onload = handler_fr0202;
    } else if ($el == 'fr0203') {
     request.onload = handler_fr0203;
    } else if ($el == 'fr0204') {
     request.onload = handler_fr0204;

    } else if ($el == 'fr0301') {
     request.onload = handler_fr0301;
    } else if ($el == 'fr0302') {
     request.onload = handler_fr0302;
    } else if ($el == 'fr0303') {
     request.onload = handler_fr0303;
    } else if ($el == 'fr0304') {
     request.onload = handler_fr0304;

    } else if ($el == 'fr0401') {
     request.onload = handler_fr0401;
    } else if ($el == 'fr0402') {
     request.onload = handler_fr0402;
    } else if ($el == 'fr0403') {
     request.onload = handler_fr0403;
    } else if ($el == 'fr0404') {
     request.onload = handler_fr0404;
    }
    request.send();
  }
 }
}

function sendHead($ls) {
 var $tlink = localStorage.getItem($ls + '.tlink');
 if (XMLHttpRequest) {
   var request = new XMLHttpRequest();
   if("withCredentials" in request) {
    // Firefox 3.5 and Safari 4
    $lang = localStorage.getItem('csi18n_lang');
    if ($lang == null) {
     $lang = window.navigator.language;
    }
    request.open('HEAD', $tlink, true);
    request.setRequestHeader("Authorization", "Basic dGVzdDA1OnRlc3Q=");
    request.setRequestHeader("X-APIKey", "e3c12c03cf320b243977d6ac389805de");
    request.setRequestHeader("Accept", "application/json");
    request.responseType = "json";
    request.onload = head_handler;
    request.send();
  }
 }
}

function sendOptions($ls) {
 var $tlink = localStorage.getItem($ls + '.tlink');
 if (XMLHttpRequest) {
   var request = new XMLHttpRequest();
   if("withCredentials" in request) {
    // Firefox 3.5 and Safari 4
    request.open('OPTIONS', $tlink, true);
    request.setRequestHeader("Authorization", "Basic dGVzdDA1OnRlc3Q=");
    request.setRequestHeader("X-APIKey", "e3c12c03cf320b243977d6ac389805de");
    request.onload = options_handler;
    request.send();
  }
 }
}

function sendPost($visitsid) {
 var d = document.getElementById("newmark_iv");
 $newmark = d.value;
 d = document.getElementById("translation_iv");
 $translation = d.value;
 d = document.getElementById("cl_iv");
 $cont_lang = d.value;
 d = document.getElementById("visibility_iv");
 $vis = d.value;

 $arr = { 'csi18n_xlate_resource' : { 'language' : $cont_lang, 'translation' : $translation, 'visibility' : $vis } };
 $json_s = JSON.stringify($arr);

 var url = "https://rest.mpsvr.com/newmarks/" + $visitsid + "/" + $newmark;
 if (XMLHttpRequest) {
   var request = new XMLHttpRequest();
   if("withCredentials" in request) {
    // Firefox 3.5 and Safari 4
    request.open('POST', url, true);
    request.setRequestHeader("Authorization", "Basic dGVzdDA1OnRlc3Q=");
    request.setRequestHeader("X-APIKey", "e3c12c03cf320b243977d6ac389805de");
    request.setRequestHeader("Content-Type", "application/json;v=1.0");
    request.onload = post_handler;
    request.send($json_s);
  }
 }
}

function sendPut($ls) {
 var d = document.getElementById("newmark_iv");
 $newmark = d.value;
 d = document.getElementById("translation_iv");
 $translation = d.value;
 d = document.getElementById("cl_iv");
 $cont_lang = d.value;
 d = document.getElementById("visibility_iv");
 $vis = d.value;

 $arr = { 'csi18n_xlate_resource' : { 'language' : $cont_lang, 'translation' : $translation, 'visibility' : $vis } };
 $json_s = JSON.stringify($arr);

 var $tlink = localStorage.getItem($ls + '.tlink');
 if (XMLHttpRequest) {
   var request = new XMLHttpRequest();
   if("withCredentials" in request) {
    // Firefox 3.5 and Safari 4
    request.open('PUT', $tlink, true);
    request.setRequestHeader("Authorization", "Basic dGVzdDA1OnRlc3Q=");
    request.setRequestHeader("X-APIKey", "e3c12c03cf320b243977d6ac389805de");
    request.setRequestHeader("Content-Type", "application/json;v=1.0");
    request.onload = put_handler;
    request.send($json_s);
  }
 }
}

function sendDelete($ls) {
 var $tlink = localStorage.getItem($ls + '.tlink');
 if (XMLHttpRequest) {
   var request = new XMLHttpRequest();
   if("withCredentials" in request) {
    // Firefox 3.5 and Safari 4
    request.open('DELETE', $tlink, true);
    request.setRequestHeader("Authorization", "Basic dGVzdDA1OnRlc3Q=");
    request.setRequestHeader("X-APIKey", "e3c12c03cf320b243977d6ac389805de");
    request.setRequestHeader("If-Modified-Since", "Tue,  1 Jan 1980 19:12:53 BST");
    request.setRequestHeader("If-None-Match", "Wibble");
    request.setRequestHeader("Accept", "application/json");
    request.responseType = "json";
    request.onload = delete_handler;
    request.send();
  }
 }
}

// callback handlers
function delete_handler() {
  $status = this.status;
  var d = document.getElementById("trn_menu");
  d.style.position = "fixed";
  d.style.fontFamily = "sans";
  d.style.right = "0px";
  d.style.top = "240px";
  d.style.zIndex = "101";
  d.style.backgroundColor = "#AADDDD";
  d.style.textAlign = "right";
  d.style.fontSize = "20px";
  d.innerHTML = escapeHtml(this.statusText);
  d.style.display = "";
}

function post_handler() {
  $status = this.status;
  var d = document.getElementById("trn_menu");
  d.style.position = "fixed";
  d.style.fontFamily = "sans";
  d.style.right = "0px";
  d.style.top = "240px";
  d.style.zIndex = "101";
  d.style.backgroundColor = "#AADDDD";
  d.style.textAlign = "right";
  d.style.fontSize = "20px";
  d.innerHTML = escapeHtml(this.statusText);
  d.style.display = "";
}

function seemore_handler() {
  $status = this.status;
   var d = document.getElementById("trn_menu");
   d.style.position = "fixed";
   d.style.fontFamily = "sans";
   d.style.right = "0px";
   d.style.top = "240px";
   d.style.zIndex = "101";
   d.style.backgroundColor = "#AADDDD";
   d.style.textAlign = "right";
   d.style.fontSize = "20px";

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   localStorage.setItem('csi18n_seemore.representations', JSON.stringify($json_o));

   var $el = '';
   var $safe_choices = '';
   for(index = 0; index < $json_o.csi18n_xlate_resources.length; index++) {
    $el = $json_o.csi18n_xlate_resources[index];
    $unsafe_choice = $el.translation;
    $tlink = $el.url;
    $safe_choices = $safe_choices + "<li><a href='javascript:trnPreferAnother(\"" + index + "\")'>" + escapeHtml($unsafe_choice) + "</a></li>";
   }
   if ($safe_choices.length > 0) {
    $safe_choices = "<nav><ul>" + $safe_choices + "</ul></nav>";
   } 
   $choices = "See more<hr>" + $safe_choices;
   d.innerHTML = $safe_choices;
   d.style.display = "";
}

function put_handler() {
  $status = this.status;
  var d = document.getElementById("trn_menu");
  d.style.position = "fixed";
  d.style.fontFamily = "sans";
  d.style.right = "0px";
  d.style.top = "240px";
  d.style.zIndex = "101";
  d.style.backgroundColor = "#AADDDD";
  d.style.textAlign = "right";
  d.style.fontSize = "20px";
  d.innerHTML = escapeHtml(this.statusText);
  d.style.display = "";
}

function preferanother_handler() {
  $status = this.status;
  var d = document.getElementById("trn_menu");
  d.style.position = "fixed";
  d.style.fontFamily = "sans";
  d.style.right = "0px";
  d.style.top = "240px";
  d.style.zIndex = "101";
  d.style.backgroundColor = "#AADDDD";
  d.style.textAlign = "right";
  d.style.fontSize = "20px";
  d.innerHTML = escapeHtml(this.statusText);
  d.style.display = "";
}

function handler_fr0001() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0001");
   var d2 = document.getElementById("upload_fr0001");
   if (currently != "off") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0001.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0001.result', $status);
   localStorage.setItem('csi18n_fr0001.tlink', this.getResponseHeader('Content-Location'));
//   d.style.display = "";
  } 
}

function handler_fr0101() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0101");
   var d2 = document.getElementById("upload_fr0101");
   if (currently != "off") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0101.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0101.result', $status);
   localStorage.setItem('csi18n_fr0101.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0102() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0102");
   var d2 = document.getElementById("upload_fr0102");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0102.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0102.result', $status); 
   localStorage.setItem('csi18n_fr0102.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0103() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0103");
   var d2 = document.getElementById("upload_fr0103");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0103.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0103.result', $status); 
   localStorage.setItem('csi18n_fr0103.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0104() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0104");
   var d2 = document.getElementById("upload_fr0104");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0104.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0104.result', $status); 
   localStorage.setItem('csi18n_fr0104.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0201() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0201");
   var d2 = document.getElementById("upload_fr0201");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0201.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0201.result', $status); 
   localStorage.setItem('csi18n_fr0201.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0202() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0202");
   var d2 = document.getElementById("upload_fr0202");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0202.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0202.result', $status); 
   localStorage.setItem('csi18n_fr0202.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0203() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0203");
   var d2 = document.getElementById("upload_fr0203");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0203.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0203.result', $status); 
   localStorage.setItem('csi18n_fr0203.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0204() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0204");
   var d2 = document.getElementById("upload_fr0204");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0204.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0204.result', $status); 
   localStorage.setItem('csi18n_fr0204.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0301() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0301");
   var d2 = document.getElementById("upload_fr0301");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0301.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0301.result', $status); 
   localStorage.setItem('csi18n_fr0301.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0302() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0302");
   var d2 = document.getElementById("upload_fr0302");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0302.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0302.result', $status); 
   localStorage.setItem('csi18n_fr0302.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0303() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0303");
   var d2 = document.getElementById("upload_fr0303");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0303.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0303.result', $status); 
   localStorage.setItem('csi18n_fr0303.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0304() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0304");
   var d2 = document.getElementById("upload_fr0304");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0304.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0304.result', $status); 
   localStorage.setItem('csi18n_fr0304.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0401() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0401");
   var d2 = document.getElementById("upload_fr0401");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0401.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0401.result', $status); 
   localStorage.setItem('csi18n_fr0401.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0402() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0402");
   var d2 = document.getElementById("upload_fr0402");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0402.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0402.result', $status); 
   localStorage.setItem('csi18n_fr0402.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0403() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0403");
   var d2 = document.getElementById("upload_fr0403");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0403.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0403.result', $status); 
   localStorage.setItem('csi18n_fr0403.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function handler_fr0404() {
  $status = this.status;
  if ($status == 200) {

   $json_o = this.response;
   if (window.ie !== false)
    $json_o = JSON.parse($json_o);
   $translation = $json_o.csi18n_xlate_resource.translation;

   var currently = localStorage.getItem('csi18n_onOrOff');
   var d1 = document.getElementById("fr0404");
   var d2 = document.getElementById("upload_fr0404");
   if (currently == "on") {
    d1.firstChild.innerHTML = escapeHtml($translation);
   } else {
    d1.innerHTML = escapeHtml($translation);
   }
   d2.innerHTML = escapeHtml($translation);
   localStorage.setItem('csi18n_fr0404.representation', JSON.stringify($json_o));
   localStorage.setItem('csi18n_fr0404.result', $status); 
   localStorage.setItem('csi18n_fr0404.tlink', this.getResponseHeader('Content-Location'));
   d1.style.display = "";
  } 
}

function options_handler() {
  $status = this.status;
  var d = document.getElementById("trn_menu");
  d.style.position = "fixed";
  d.style.fontFamily = "sans";
  d.style.right = "0px";
  d.style.top = "240px";
  d.style.zIndex = "101";
  d.style.backgroundColor = "#AADDDD";
  d.style.textAlign = "right";
  d.style.fontSize = "20px";
  d.innerHTML = escapeHtml(this.statusText) + "<br>" + escapeHtml(this.responseText);
  d.style.display = "";
}

function head_handler() {
  $status = this.status;
  var d = document.getElementById("trn_menu");
  d.style.position = "fixed";
  d.style.fontFamily = "sans";
  d.style.right = "0px";
  d.style.top = "240px";
  d.style.zIndex = "101";
  d.style.backgroundColor = "#AADDDD";
  d.style.textAlign = "right";
  d.style.fontSize = "20px";
  d.innerHTML = escapeHtml(this.statusText) + "<br>" + escapeHtml(this.responseText);
  d.style.display = "";
}

///////////////////////////////////////////////////////////////////

//
// Service menu and handlers: hyperlinks, credentials and language
// toggleShowServiceMenu effected by single-click on Globe
//
function toggleShowServiceMenu() {
 var d = document.getElementById("svc_menu");
 if (d.style.display == "") {
  d.style.display = "none";
 } else {
  d.style.position = "fixed";
  d.style.fontFamily = "sans";
  d.style.right = "0px";
  d.style.top = "100px";
  d.style.width = "33%";
  d.style.zIndex = "100";
  d.style.backgroundColor = "#AADDDD";
  d.style.textAlign = "right";
  d.style.fontSize = "20px";
  d.innerHTML = "<a href='javascript:toggleShowHyperlinks()'>hyperlinks on/off<a><br> " +
 "<a href='javascript:acceptUsername()'>username</a><br>" +
 "<a href='javascript:acceptPassword()'>password</a><br>" +
 "<a href='javascript:acceptApikey()'>apikey</a><br>" +
 "<a href='javascript:acceptDefLang()'>Default Language</a><br>";
  d.style.display = "";
 }
}

// Translation menu effected by click text in the speech bubbles while 
// hyperlinks on
// 
function toggleShowTranslationMenu($ls) {
 var d = document.getElementById("trn_menu");

 $res = localStorage.getItem($ls + '.representation');
 if ($res != '') {
  $seemore_uri = $res.csi18n_per_lang_preference;
 } else {
  $seemore_uri = '';
 }
 localStorage.setItem('csi18n_seemore.per_lang_pref', $seemore_uri);
	
 if (d.style.display == "") {
  d.style.display = "none";
 } else {
  d.style.position = "fixed";
  d.style.fontFamily = "sans";
  d.style.right = "0px";
  d.style.top = "240px";
  d.style.zIndex = "100";
  d.style.backgroundColor = "#AADDDD";
  d.style.textAlign = "right";
  d.style.fontSize = "20px";
  d.style.height = "";
  d.style.width = "33%";
  d.innerHTML = "<a href='javascript:trnSeeMore(\"" + $ls + "\")'>See more</a><br>" +
 "<a href='javascript:trnOfferAnother(\"" + $ls + "\")'>Offer another</a><br>" +
 "<a href='javascript:trnEdit(\"" + $ls + "\")'>- Edit</a><br>" +
 "<a href='javascript:trnDelete(\"" + $ls + "\")'>- Delete</a><br>" +
 "<a href='javascript:trnOptions(\"" + $ls + "\")'>- Options</a><br>" +
 "<a href='javascript:trnHead(\"" + $ls + "\")'>- Head</a><br>" +
 "<a href='http://csi18n.mpsvr.com/index.php/Storyboard_03'>- Bump</a><br>" +
 "<a href='http://csi18n.mpsvr.com/index.php/Storyboard_03'>- UnBump</a><br>" +
 "<a href='http://csi18n.mpsvr.com/index.php/Storyboard_01'>- Lock</a><br>" +
 "<a href='http://csi18n.mpsvr.com/index.php/Storyboard_01'>- Unlock</a><br>" + 
 "<a href='http://csi18n.mpsvr.com/index.php/Storyboard_01'>- History</a><br>";
  d.style.display = "";
 }
}

function toggleShowHyperlinks() {
 var currently = localStorage.getItem('csi18n_onOrOff');
 if (currently != "off") {
  localStorage.setItem('csi18n_onOrOff','off');
 } else {
  localStorage.setItem('csi18n_onOrOff','on');
 }
}

///////////////////////////////////////////////////////////////////

function acceptUsername() {
 $username = localStorage.getItem('csi18n_un');
 var rv = prompt("Username", $username);
 if (rv != null) {
  localStorage.setItem('csi18n_un', rv);
 }
}

function acceptPassword() {
 $password = localStorage.getItem('csi18n_pw');
 var rv = prompt("Password", $password);
 if (rv != null) {
  localStorage.setItem('csi18n_pw', rv);
 }
}

function acceptApikey() {
 $apikey = localStorage.getItem('csi18n_key');
 var rv = prompt("APIKey", $apikey);
 if (rv != null) {
  localStorage.setItem('csi18n_key', rv);
 }
}

function acceptDefLang() {
 $deflang = localStorage.getItem('csi18n_lang');
 if ($deflang == null) {
  $deflang = window.navigator.language;
 }
 var rv = prompt("New Language", $deflang);
 if (rv != null) {
  localStorage.setItem('csi18n_lang', rv);
 }
}

///////////////////////////////////////////////////////////////////

//
// JS for creating the bubble on page (or hiding it)
//
function createDialog($el, $corner, $totx, $toty, $posx, $posy, $size, $maxwidth, $style, $newmark, $visitsid) {
 var d = document.getElementById($el);
 d.style.display = "none";
 d.style.left = "auto";
 d.style.right = "auto";
 d.style.top = "auto";
 d.style.bottom = "auto";

 if ($el === 'fr0001') {
  localStorage.setItem('csi18n_fr0001.result', 0);
  localStorage.setItem('csi18n_fr0001.newmark', $newmark);
  localStorage.setItem('csi18n_fr0001.representation', '');
  localStorage.setItem('csi18n_fr0001.tlink', '');
  localStorage.setItem('csi18n_fr0001.visitsid', $visitsid);

 } else if ($el === 'fr0101') {
  localStorage.setItem('csi18n_fr0101.result', 0);
  localStorage.setItem('csi18n_fr0101.newmark', $newmark);
  localStorage.setItem('csi18n_fr0101.representation', '');
  localStorage.setItem('csi18n_fr0101.tlink', '');
  localStorage.setItem('csi18n_fr0101.visitsid', $visitsid);
 } else if ($el === 'fr0102') {
  localStorage.setItem('csi18n_fr0102.result', 0);
  localStorage.setItem('csi18n_fr0102.newmark', $newmark);
  localStorage.setItem('csi18n_fr0102.representation', '');
  localStorage.setItem('csi18n_fr0102.tlink', '');
  localStorage.setItem('csi18n_fr0102.visitsid', $visitsid);
 } else if ($el === 'fr0103') {
  localStorage.setItem('csi18n_fr0103.result', 0);
  localStorage.setItem('csi18n_fr0103.newmark', $newmark);
  localStorage.setItem('csi18n_fr0103.representation', '');
  localStorage.setItem('csi18n_fr0103.tlink', '');
  localStorage.setItem('csi18n_fr0103.visitsid', $visitsid);
 } else if ($el === 'fr0104') {
  localStorage.setItem('csi18n_fr0104.result', 0);
  localStorage.setItem('csi18n_fr0104.newmark', $newmark);
  localStorage.setItem('csi18n_fr0104.representation', '');
  localStorage.setItem('csi18n_fr0104.tlink', '');
  localStorage.setItem('csi18n_fr0104.visitsid', $visitsid);

 } else if ($el === 'fr0201') {
  localStorage.setItem('csi18n_fr0201.result', 0);
  localStorage.setItem('csi18n_fr0201.newmark', $newmark);
  localStorage.setItem('csi18n_fr0201.representation', '');
  localStorage.setItem('csi18n_fr0201.tlink', '');
  localStorage.setItem('csi18n_fr0201.visitsid', $visitsid);
 } else if ($el === 'fr0202') {
  localStorage.setItem('csi18n_fr0202.result', 0);
  localStorage.setItem('csi18n_fr0202.newmark', $newmark);
  localStorage.setItem('csi18n_fr0202.representation', '');
  localStorage.setItem('csi18n_fr0202.tlink', '');
  localStorage.setItem('csi18n_fr0202.visitsid', $visitsid);
 } else if ($el === 'fr0203') {
  localStorage.setItem('csi18n_fr0203.result', 0);
  localStorage.setItem('csi18n_fr0203.newmark', $newmark);
  localStorage.setItem('csi18n_fr0203.representation', '');
  localStorage.setItem('csi18n_fr0203.tlink', '');
  localStorage.setItem('csi18n_fr0203.visitsid', $visitsid);
 } else if ($el === 'fr0204') {
  localStorage.setItem('csi18n_fr0204.result', 0);
  localStorage.setItem('csi18n_fr0204.newmark', $newmark);
  localStorage.setItem('csi18n_fr0204.representation', '');
  localStorage.setItem('csi18n_fr0204.tlink', '');
  localStorage.setItem('csi18n_fr0204.visitsid', $visitsid);

 } else if ($el === 'fr0301') {
  localStorage.setItem('csi18n_fr0301.result', 0);
  localStorage.setItem('csi18n_fr0301.newmark', $newmark);
  localStorage.setItem('csi18n_fr0301.representation', '');
  localStorage.setItem('csi18n_fr0301.tlink', '');
  localStorage.setItem('csi18n_fr0301.visitsid', $visitsid);
 } else if ($el === 'fr0302') {
  localStorage.setItem('csi18n_fr0302.result', 0);
  localStorage.setItem('csi18n_fr0302.newmark', $newmark);
  localStorage.setItem('csi18n_fr0302.representation', '');
  localStorage.setItem('csi18n_fr0302.tlink', '');
  localStorage.setItem('csi18n_fr0302.visitsid', $visitsid);
 } else if ($el === 'fr0303') {
  localStorage.setItem('csi18n_fr0303.result', 0);
  localStorage.setItem('csi18n_fr0303.newmark', $newmark);
  localStorage.setItem('csi18n_fr0303.representation', '');
  localStorage.setItem('csi18n_fr0303.tlink', '');
  localStorage.setItem('csi18n_fr0303.visitsid', $visitsid);
 } else if ($el === 'fr0304') {
  localStorage.setItem('csi18n_fr0304.result', 0);
  localStorage.setItem('csi18n_fr0304.newmark', $newmark);
  localStorage.setItem('csi18n_fr0304.representation', '');
  localStorage.setItem('csi18n_fr0304.tlink', '');
  localStorage.setItem('csi18n_fr0304.visitsid', $visitsid);

 } else if ($el === 'fr0401') {
  localStorage.setItem('csi18n_fr0401.result', 0);
  localStorage.setItem('csi18n_fr0401.newmark', $newmark);
  localStorage.setItem('csi18n_fr0401.representation', '');
  localStorage.setItem('csi18n_fr0401.tlink', '');
  localStorage.setItem('csi18n_fr0401.visitsid', $visitsid);
 } else if ($el === 'fr0402') {
  localStorage.setItem('csi18n_fr0402.result', 0);
  localStorage.setItem('csi18n_fr0402.newmark', $newmark);
  localStorage.setItem('csi18n_fr0402.representation', '');
  localStorage.setItem('csi18n_fr0402.tlink', '');
  localStorage.setItem('csi18n_fr0402.visitsid', $visitsid);
 } else if ($el === 'fr0403') {
  localStorage.setItem('csi18n_fr0403.result', 0);
  localStorage.setItem('csi18n_fr0403.newmark', $newmark);
  localStorage.setItem('csi18n_fr0403.representation', '');
  localStorage.setItem('csi18n_fr0403.tlink', '');
  localStorage.setItem('csi18n_fr0403.visitsid', $visitsid);
 } else if ($el === 'fr0404') {
  localStorage.setItem('csi18n_fr0404.result', 0);
  localStorage.setItem('csi18n_fr0404.newmark', $newmark);
  localStorage.setItem('csi18n_fr0404.representation', '');
  localStorage.setItem('csi18n_fr0404.tlink', '');
  localStorage.setItem('csi18n_fr0404.visitsid', $visitsid);
 } 

 if ($corner != 'hide') {
  $rv = sendGet($el, $newmark, $visitsid);
  if (typeof $rv === 'undefined') {
   $translation = 'undefined';
  } else {
   $translation = $rv;
  }
 }

 if (localStorage.getItem('csi18n_onOrOff') == 'on') {
  if ($el === 'fr0001') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0001\")'>" + escapeHtml($translation) + "</a>"; 

  } else if ($el === 'fr0101') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0101\")'>" + escapeHtml($translation) + "</a>"; 
  } else if ($el === 'fr0102') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0102\")'>" + escapeHtml($translation) + "</a>"; 
  } else if ($el === 'fr0103') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0103\")'>" + escapeHtml($translation) + "</a>"; 
  } else if ($el === 'fr0104') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0104\")'>" + escapeHtml($translation) + "</a>"; 

  } else if ($el === 'fr0201') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0201\")'>" + escapeHtml($translation) + "</a>"; 
  } else if ($el === 'fr0202') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0202\")'>" + escapeHtml($translation) + "</a>"; 
  } else if ($el === 'fr0203') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0203\")'>" + escapeHtml($translation) + "</a>"; 
  } else if ($el === 'fr0204') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0204\")'>" + escapeHtml($translation) + "</a>"; 

  } else if ($el === 'fr0301') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0301\")'>" + escapeHtml($translation) + "</a>"; 
  } else if ($el === 'fr0302') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0302\")'>" + escapeHtml($translation) + "</a>"; 
  } else if ($el === 'fr0303') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0303\")'>" + escapeHtml($translation) + "</a>"; 
  } else if ($el === 'fr0304') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0304\")'>" + escapeHtml($translation) + "</a>"; 

  } else if ($el === 'fr0401') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0401\")'>" + escapeHtml($translation) + "</a>"; 
  } else if ($el === 'fr0402') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0402\")'>" + escapeHtml($translation) + "</a>"; 
  } else if ($el === 'fr0403') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0403\")'>" + escapeHtml($translation) + "</a>"; 
  } else if ($el === 'fr0404') {
   d.innerHTML = "<a href='javascript:toggleShowTranslationMenu(\"csi18n_fr0404\")'>" + escapeHtml($translation) + "</a>"; 
  }
 } else {
  d.innerHTML = escapeHtml($translation); 
 }

 if ($corner == 'BR') {
  d.style.position = "absolute";
  d.style.right = ($totx - $posx) + "px";
  d.style.bottom = ($toty - $posy) + "px";
  d.style.zIndex = "100";
  d.style.backgroundColor = "#DDDDDD";
  d.style.textAlign = "right";

 } else if ($corner == 'TR') {
  d.style.position = "absolute";
  d.style.right = ($totx - $posx) + "px";
  d.style.top = $posy + "px";
  d.style.fontSize = "20px";
  d.style.zIndex = "100";
  d.style.backgroundColor = "#FFFFFF";
  d.style.textAlign = "right";

 } else if ($corner == 'BL') {
  d.style.position = "absolute";
  d.style.left = $posx + "px";;
  d.style.bottom = ($toty - $posy) + "px";
  d.style.fontSize = "20px";
  d.style.zIndex = "100";
  d.style.backgroundColor = "#DDDDDD";
  d.style.textAlign = "left";

 } else if ($corner == 'TL') {
  d.style.position = "absolute";
  d.style.left = $posx + "px";
  d.style.top = $posy + "px";
  d.style.fontSize = "20px";
  d.style.zIndex = "100";
  d.style.backgroundColor = "#FFFFFF";
  d.style.textAlign = "left";
 }

 if ($corner != "hide") {
  d.style.display = "";
  d.style.fontSize = $size + "px";
  d.style.fontFamily = "sans";
  d.style.fontStyle = $style;
  if ($maxwidth != "0") {
   d.style.maxWidth = $maxwidth + "px";
  } else {
   d.style.maxWidth = "";
  }
 }
}

///////////////////////////////////////////////////////////////////

//
//
// $el, $corner, $totx, $toty, $posx, $posy, $size, $maxwidth, $style, $newmark
function xkcdShow() {
 $visitsid = 7;
// createDialog(elem,  corner, pg_wid, pg_hght, corner_x, corner_y, txt_sz, bubble_wid, "", "xkcd-small_moon-fr0101", $visitsid);
 createDialog("fr0001", "TL", 800, 2048, 0, 264, "12", "595", "", "xkcd-small_moon-fr0001", $visitsid);
 createDialog("fr0101", "BR", 800, 2048, 164, 43, "12", "160", "", "xkcd-small_moon-fr0101", $visitsid);
 createDialog("fr0102", "TL", 800, 2048, 23, 53, "12", "145", "", "xkcd-small_moon-fr0102", $visitsid);
// createDialog("fr0103", "TL", 800, 2048, 23, 53, "12", "145", "", "xkcd-small_moon-fr0103", $visitsid);
// createDialog("fr0104", "TL", 800, 2048, 23, 53, "12", "145", "", "xkcd-small_moon-fr0104", $visitsid);

 createDialog("fr0201", "BR", 800, 2048, 320, 43, "12", "135", "", "xkcd-small_moon-fr0201", $visitsid);
 createDialog("fr0202", "TL", 800, 2048, 232, 61, "12", "87", "", "xkcd-small_moon-fr0202", $visitsid);
// createDialog("fr0203", "BR", 800, 2048, 320, 43, "12", "135", "", "xkcd-small_moon-fr0203", $visitsid);
// createDialog("fr0204", "TL", 800, 2048, 232, 61, "12", "87", "", "xkcd-small_moon-fr0204", $visitsid);

 createDialog("fr0301", "TL", 800, 2048, 342, 102, "12", "46", "", "xkcd-small_moon-fr0301", $visitsid);
// createDialog("fr0302", "TL", 800, 2048, 342, 102, "12", "46", "", "xkcd-small_moon-fr0302", $visitsid);
// createDialog("fr0303", "TL", 800, 2048, 342, 102, "12", "46", "", "xkcd-small_moon-fr0303", $visitsid);
// createDialog("fr0304", "TL", 800, 2048, 342, 102, "12", "46", "", "xkcd-small_moon-fr0304", $visitsid);

 createDialog("fr0401", "BR", 800, 2048, 589, 82, "12", "178", "", "xkcd-small_moon-fr0401", $visitsid);
 createDialog("fr0402", "TL", 800, 2048, 431, 91, "12", "162", "", "xkcd-small_moon-fr0402", $visitsid);
 createDialog("fr0403", "TL", 800, 2048, 406, 162, "12", "103", "", "xkcd-small_moon-fr0403", $visitsid);
// createDialog("fr0404", "TL", 800, 2048, 406, 162, "12", "103", "", "xkcd-small_moon-fr0404", $visitsid);
}

function xkcdShowLines() {
 DrawLine(17, 45, 128, 198);
 DrawLine(137, 93, 138, 195);
 DrawLine(226, 47, 290, 196); 
 DrawLine(294, 123, 296, 195);
 DrawLine(417, 89, 425, 156);
 DrawLine(441, 181, 475, 206);
 DrawLine(530, 150, 492, 206);
}

//
// madox2 @ http://stackoverflow.com/questions/4270485/drawing-lines-on-html-page
// as modified by suggestion on the same page to include transform:rotate('+deg+'deg); for
// the benefit of IE
function DrawLine(x1, y1, x2, y2){

    if(y1 < y2){
        var pom = y1;
        y1 = y2;
        y2 = pom;
        pom = x1;
        x1 = x2;
        x2 = pom;
    }

    var a = Math.abs(x1-x2);
    var b = Math.abs(y1-y2);
    var c;
    var sx = (x1+x2)/2 ;
    var sy = (y1+y2)/2 ;
    var width = Math.sqrt(a*a + b*b ) ;
    var x = sx - width/2;
    var y = sy;

    a = width / 2;

    c = Math.abs(sx-x);

    b = Math.sqrt(Math.abs(x1-x)*Math.abs(x1-x)+Math.abs(y1-y)*Math.abs(y1-y) );

    var cosb = (b*b - a*a - c*c) / (2*a*c);
    var rad = Math.acos(cosb);
    var deg = (rad*180)/Math.PI

    htmlns = "http://www.w3.org/1999/xhtml";
    div = document.createElementNS(htmlns, "div");
    div.setAttribute('style','border:1px solid black;width:'+width+'px;height:0px;transform:rotate('+deg+'deg);-moz-transform:rotate('+deg+'deg);-webkit-transform:rotate('+deg+'deg);position:absolute;top:'+y+'px;left:'+x+'px;');   

    document.getElementById("tochterAusElysium").appendChild(div);
}

// XSS. Storing:
//   hello</a><img src=bogus onerror=alert(1337)><a href="">
// is an XSS vuln: sanitise text before use. In practice, I only seem to 
// use .innerHtml for use so either .innerHtml = escapeHtml(unsafe) or
// name vars as safe/unsafe and only assign a safe to .innerHtml
//
// bjornd @ http://stackoverflow.com/questions/6234773/can-i-escape-html-special-chars-in-javascript
function escapeHtml(unsafe) {
    return unsafe
         .replace(/&/g, "&amp;")
         .replace(/</g, "&lt;")
         .replace(/>/g, "&gt;")
         .replace(/"/g, "&quot;")
         .replace(/'/g, "&#039;");
}
//" <-- emacs discolours below unless I terminate the stroke-quote-stroke above

//
// It's 2014 and it's /still/ necessary to detect the browser. HOLY CRAP
// 
// IE doesn't automagical a JSON response string into JSON proper, so make a global
// called window.ie that is false for working browsers, and !false otherwise. Not that
// I'm implying this page will render on anything under IE11.
//   $json_o = this.response;
//   if (window.ie !== false)
//    $json_o = JSON.parse($json_o);
//   $translation = $json_o.csi18n_xlate_resource.translation;
// 
// mario @ http://stackoverflow.com/questions/19999388/jquery-check-if-user-is-using-ie
function detectIE() {
    var ua = window.navigator.userAgent;
    var msie = ua.indexOf('MSIE ');
    var trident = ua.indexOf('Trident/');

    if (msie > 0) {
        // IE 10 or older => return version number
        return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
    }

    if (trident > 0) {
        // IE 11 (or newer) => return version number
        var rv = ua.indexOf('rv:');
        return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
    }

    // other browser
    return false;
}

function showWhatWasImgTitle(){
  var d = document.getElementById("fr0001");
  d.style.display = "";
}

function hideWhatWasImgTitle(){
  var d = document.getElementById("fr0001");
  d.style.display = "none";
}

function showUploadForm(){
  var d = document.getElementById("upload-form");
  d.style.display = "";
}

function hideUploadForm(){
  var d = document.getElementById("upload-form");
  d.style.display = "none";
}

function toggleUploadForm(){
  var d = document.getElementById("upload-form");
  if (d.style.display != "none") {
    d.style.display = "none";
  } else {
    d.style.display = "";
  }
}

///////////////////////////////////////////////////////////////////

//
// Setup when never been here before. Preload with credents and use non-localised English
// 
function onLoad() {
 window.ie = detectIE();
 
 var currently = localStorage.getItem('csi18n_onOrOff');
 if (currently != "on" && currently != "off") {
  localStorage.setItem('csi18n_onOrOff', "on");
  localStorage.setItem('csi18n_un', "test05");
  localStorage.setItem('csi18n_pw', "test");
  localStorage.setItem('csi18n_key', "e3c12c03cf320b243977d6ac389805de");
  localStorage.setItem('csi18n_lang', "en");
  localStorage.setItem('csi18n_seemore.representations', '');
  localStorage.setItem('csi18n_seemore.per_lang_pref', '');
 }
<?php
   if ($lang !== '') {
   echo "localStorage.setItem('csi18n_lang', '$lang');";
   }
?>
 xkcdShow();
 hideWhatWasImgTitle();
 hideUploadForm();
 xkcdShowLines();
}
</script>
</head>

<!--
///////////////////////////////////////////////////////////////////
-->

<body onload='javascript:onLoad()'>
<div id="tochterAusElysium" style="position: absolute; background: #BBBBBB; font-size:10px; width:800px; height:2048px; font-family:sans;">
<img src="xkcd-notext-small_moon.png" alt="" usemap="#TupacVsThomasTheTankEngine"/><br>
Original work: <a href="http://xkcd.com/1458/">http://xkcd.com/1458/</a><br>
[ <a href="../20141206">prev</a> | <a href="../">up</a> | <a href="../documents">next</a> ]<br>


<div id="globe" class= "" style="position:fixed; right:0; top: 0;"><img onclick="javascript:toggleShowServiceMenu()" src='../translationglobe.png'></div>
<div id="fr0001" class="" style="display:none" >frame 00 text 01</div>

<div id="fr0101" class="" style="display:none" >frame 01 text 01</div>
<div id="fr0102" class="" style="display:none" >frame 01 text 02</div>
<div id="fr0103" class="" style="display:none" >frame 01 text 03</div>
<div id="fr0104" class="" style="display:none" >frame 01 text 04</div>

<div id="fr0201" class="" style="display:none" >frame 02 text 01</div>
<div id="fr0202" class="" style="display:none" >frame 02 text 02</div>
<div id="fr0203" class="" style="display:none" >frame 02 text 03</div>
<div id="fr0204" class="" style="display:none" >frame 02 text 04</div>

<div id="fr0301" class="" style="display:none" >frame 03 text 01</div>
<div id="fr0302" class="" style="display:none" >frame 03 text 02</div>
<div id="fr0303" class="" style="display:none" >frame 03 text 03</div>
<div id="fr0304" class="" style="display:none" >frame 03 text 04</div>

<div id="fr0401" class="" style="display:none" >frame 04 text 01</div>
<div id="fr0402" class="" style="display:none" >frame 04 text 02</div>
<div id="fr0403" class="" style="display:none" >frame 04 text 03</div>
<div id="fr0404" class="" style="display:none" >frame 04 text 04</div>

<!-- 
Using area map to make text appear as per "Jurassic World"
The 'Hey guys!' text is meant to appear as the <img> title. In the original, this causes the
text to appear only when hovering over the image. To my knowledge, it's not possible to click on
such text: while onLoad /could/ obtain the translation and insert it into place, it couldn't 
then be selected for replacement by the service.
Rather than rework the UI to make the text selectable without clickin on it, Imma gonna cheat 
here. Imma gonna make the the T-Rex clickable, and THAT makes the text appear. Once appeared,
the text can be edited like the rest 
-->
<!--
<div id="fr0401" class="" style="display:none" >Hey guys! What's eating you? Ha ha ha it's me! Oh, what fun we have.</div>
-->

<div id="svc_menu" class="" style="display:none" ><a href="http://www.youtube.com/watch?v=CiGPTL8bnC4">Sandy White</a></div>
<div id="trn_menu" class="" style="display:none" ><a href="http://www.gutenberg.org/cache/epub/74/pg74.txt">Mark Twain</a></div>

<!--
///////////////////////////////////////////////////////////////////
-->

<map name="TupacVsThomasTheTankEngine">
  <!-- area poly generated at http://www.image-maps.com/ -->
  <area  alt="" title="" shape="rect" coords="6,123,595,264" style="outline:2px;" onMouseOver="showWhatWasImgTitle()" />
</map>

<p>
<br>
XKCD example page from 2014-dec-11<br>

<div onClick="javascript:toggleUploadForm()">[Click here to upload your own]</div>
<div id="upload-form">
<form action="" method="POST">
<input type="text" name="username" value="username"></input><br>
<input type="password" name="password" value="password"></input><br>
<textarea rows=3 cols=30 id="upload_fr0001" name="upload_fr0001"></textarea><br>

<textarea rows=3 cols=30 id="upload_fr0101" name="upload_fr0101"></textarea><br>
<textarea rows=3 cols=30 id="upload_fr0102" name="upload_fr0102"></textarea><br>
<!--
<textarea rows=3 cols=30 id="upload_fr0103" name="upload_fr0103"></textarea><br>
<textarea rows=3 cols=30 id="upload_fr0104" name="upload_fr0104"></textarea><br>
-->

<textarea rows=3 cols=30 id="upload_fr0201" name="upload_fr0201"></textarea><br>
<textarea rows=3 cols=30 id="upload_fr0202" name="upload_fr0202"></textarea><br>
<!--
<textarea rows=3 cols=30 id="upload_fr0203" name="upload_fr0203"></textarea><br>
<textarea rows=3 cols=30 id="upload_fr0204" name="upload_fr0204"></textarea><br>
-->

<textarea rows=3 cols=30 id="upload_fr0301" name="upload_fr0301"></textarea><br>
<!--
<textarea rows=3 cols=30 id="upload_fr0302" name="upload_fr0302"></textarea><br>
<textarea rows=3 cols=30 id="upload_fr0303" name="upload_fr0303"></textarea><br>
<textarea rows=3 cols=30 id="upload_fr0304" name="upload_fr0304"></textarea><br>
-->

<textarea rows=3 cols=30 id="upload_fr0401" name="upload_fr0401"></textarea><br>
<textarea rows=3 cols=30 id="upload_fr0402" name="upload_fr0402"></textarea><br>
<textarea rows=3 cols=30 id="upload_fr0403" name="upload_fr0403"></textarea><br>
<!--
<textarea rows=3 cols=30 id="upload_fr0404" name="upload_fr0404"></textarea><br>
-->
<input type=submit value=submit>
</form>
</div>

<br>
<br>
<br>

<ol>
  <li><p style="margin-bottom: 0cm">Visit <a href="https://xkcd.com/">https://xkcd.com/</a></p>
    </li><li><p style="margin-bottom: 0cm">Capture title to clipboard</p>
    </li><li><p style="margin-bottom: 0cm">Hover image: is there a title=
      popup? If so, note as fr0001</p>
    </li><li><p style="margin-bottom: 0cm">Right-click image | save image as
      | xkcd-orig-&lt;title&gt;.png | save</p>
    </li><li><p style="margin-bottom: 0cm">Open GIMP</p>
    </li><li><p style="margin-bottom: 0cm">File | open |
      xkcd-orig-&lt;title&gt;.png | open</p>
    </li><li><p style="margin-bottom: 0cm">file | save as |
      xkcd-orig-&lt;title&gt;.xcf | save</p>
    </li><li><p style="margin-bottom: 0cm">print the image</p>
    <ol>
      <li><p style="margin-bottom: 0cm">title the image</p>
	</li><li><p style="margin-bottom: 0cm">label the textual elements
	  (fr0104 etc)</p>
	</li><li><p style="margin-bottom: 0cm">label point elements (speech
	  line)</p>
	</li></ol>
    </li><li><p style="margin-bottom: 0cm">Write tables 
      </p>
    <ol>
      <li><p style="margin-bottom: 0cm">textual</p>
	<ol>
	  <li><p style="margin-bottom: 0cm">one row per textual elements</p>
	    </li><li><p style="margin-bottom: 0cm">cols: corner; w, x,y</p>
	    </li></ol>
	</li><li><p style="margin-bottom: 0cm">point elements</p>
	<ol>
	  <li><p style="margin-bottom: 0cm">one row per two points (pt1,
	      pt2)</p>
	    </li><li><p style="margin-bottom: 0cm">Cols: xy-&gt;xy</p>
	    </li></ol>
	</li></ol>
    </li><li><p style="margin-bottom: 0cm">Co-ords:</p>
    <ol>
      <li><p style="margin-bottom: 0cm">For each textual element</p>
	<ol>
	  <li><p style="margin-bottom: 0cm">determine where the corner
	      should go (just tl, tr, bl, br for now)</p>
	    </li><li><p style="margin-bottom: 0cm">determine max width of bubble</p>
	    </li><li><p style="margin-bottom: 0cm">Get pixel co-ords for textual
	      element and point elements</p>
	    </li></ol>
	</li></ol>
    </li><li><p style="margin-bottom: 0cm">Erase all textual and speech
      bubble elements</p>
    </li><li><p style="margin-bottom: 0cm">File | save as |
      xkcd-notext-&lt;title&gt;.xcf</p>
    </li><li><p style="margin-bottom: 0cm">File | export  | export |
      export</p>
    </li><li><p style="margin-bottom: 0cm">Close gimp</p>
    </li><li><p style="margin-bottom: 0cm">At <a href="http://www.pectw.net/">www.pectw.net</a>,
      mkdir -p ~/csi18n/xkcd/&lt;title&gt; //title should use underscore
      not spaces</p>
    </li><li><p style="margin-bottom: 0cm">scp
      ~/Worklife/mpsvr.com/csi18n/xkcd-notext-&lt;title&gt;.png
      <a href="mailto:al@www.pectw.net">al@www.pectw.net</a>:~/csi18n/xkcd/&lt;title&gt;</p>
    </li><li><p style="margin-bottom: 0cm">At <a href="http://www.pectw.net/">www.pectw.net</a></p>
    <ol>
      <li><p style="margin-bottom: 0cm">cd ~/csi18n/xkcd/&lt;title&gt;</p>
	</li><li><p style="margin-bottom: 0cm">cp ../20141201/index.php . (or
	  whichever is most recent version)</p>
	</li><li><p style="margin-bottom: 0cm">cp ../20141201/index.html .</p>
	</li><li><p style="margin-bottom: 0cm">Edit index.html</p>
	<ol>
	  <li><p style="margin-bottom: 0cm">search/replace previous title
	      with new</p>
	    </li><li><p style="margin-bottom: 0cm">IMG SRC to uploaded image</p>
	    </li><li><p style="margin-bottom: 0cm">Change attribution</p>
	    </li></ol>
	</li><li><p style="margin-bottom: 0cm">Change date at bottom</p>
	<ol>
	  <li><p style="margin-bottom: 0cm">change code to handle particular
	      number of elements</p>
	    <ol>
	      <li><p style="margin-bottom: 0cm">handler_X()</p>
		</li><li><p style="margin-bottom: 0cm">if ($el == 'X'</p>
		</li><li><p style="margin-bottom: 0cm">localstorage.setItem</p>
		</li><li><p style="margin-bottom: 0cm">d.innerHTMLs</p>
		</li><li><p style="margin-bottom: 0cm">xkcdShow()</p>
		</li><li><p style="margin-bottom: 0cm">xkcdShowLines()</p>
		</li><li><p style="margin-bottom: 0cm">&lt;div id=X</p>
		</li></ol>
	    </li><li><p style="margin-bottom: 0cm">Change &lt;div&gt;s after &lt;body&gt;
	      to original text</p>
	    </li><li><p style="margin-bottom: 0cm">Change xkcdShow() for BT, TL
	      etc, co-ords and widths</p>
	    </li><li><p style="margin-bottom: 0cm">Change xkcdShowLines() for
	      speech lines</p>
	    </li><li><p style="margin-bottom: 0cm">hidden image title?</p>
	    <ol>
	      <li><p style="margin-bottom: 0cm">Uncomment hideWhatWasImgTitle</p>
		</li><li><p style="margin-bottom: 0cm">hideWhatWasImgTitle,
		  showWhatWasImgTitle correct element</p>
		</li><li><p style="margin-bottom: 0cm">Correct image-map via
		  <a href="http://www.image-maps.com/">http://www.image-maps.com/</a></p>
		<ol>
		  <li><p style="margin-bottom: 0cm">Use the first &lt;area  tag
		      in the html code</p>
		    </li></ol>
		</li></ol>
	    </li></ol>
	</li></ol>
    </li><li><p style="margin-bottom: 0cm">Tie in this page to any indexing
      pages</p>
    </li><li><p style="margin-bottom: 0cm">Added English text as available
      translation 
      </p>
    <ol>
      <li><p style="margin-bottom: 0cm">For each undefined</p>
	<ol>
	  <li><p style="margin-bottom: 0cm">Click</p>
	    </li><li><p style="margin-bottom: 0cm">Offer Another</p>
	    </li><li><p style="margin-bottom: 0cm">Add original English</p>
	    </li><li><p style="margin-bottom: 0cm">Anonymous</p>
	    </li><li><p style="margin-bottom: 0cm">Submit</p>
	    </li></ol>
	</li><li><p style="margin-bottom: 0cm">Make text a bit larger/smaller to
	  suit</p>
	</li></ol>
    </li><li><p style="margin-bottom: 0cm">Adjust co-ords to suit</p>
    </li><li><p style="margin-bottom: 0cm">These cribs 
      </p>
    <ol>
      <li><p style="margin-bottom: 0cm">Edit in word processor</p>
	</li><li><p style="margin-bottom: 0cm">save as html</p>
	</li><li><p style="margin-bottom: 0cm">view as html</p>
	<p style="margin-bottom: 0cm">rowscut and paste source html into
	  index.html</p>
	</li></ol>
</li></ol>

Next time<br> 
1. query string in visitsid and lang<br>
</div>
</body>
</html>
